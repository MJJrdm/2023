(function(){"use strict";var e={1438:function(e,t,a){var s=a(6369),l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],n={name:"App",components:{}},i=n,r=a(1001),u=(0,r.Z)(i,l,o,!1,null,null,null),c=u.exports,d=a(3822);const m=40,p=[{id:1,value:1,color:"rgba(255,148,148,0.8)"},{id:2,value:2,color:"rgba(255,155,95,0.8)"},{id:3,value:3,color:"rgba(252,231,150,0.8)"},{id:4,value:4,color:"rgba(206,159,103,0.8)"},{id:5,value:5,color:"rgba(255,175,228,0.8)"},{id:6,value:6,color:"rgba(206,142,252,0.8)"},{id:7,value:7,color:"rgba(154,235,218,0.8)"},{id:8,value:8,color:"rgba(157,196,255,0.8)"}],h={id:1,matrixValue:[[0,0,0,0,0,0,-1],[0,0,0,0,0,0,-1],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,-1,-1,-1,-1]],month:1,day:1,gameName:"",duration:"00:00"},f=[[{label:"JAN",value:1,className:"",isMonth:!0,dateValue:1},{label:"FEB",value:2,className:"",isMonth:!0,dateValue:2},{label:"MAR",value:3,className:"",isMonth:!0,dateValue:3},{label:"APR",value:4,className:"",isMonth:!0,dateValue:4},{label:"MAY",value:5,className:"",isMonth:!0,dateValue:5},{label:"JUN",value:6,className:"",isMonth:!0,dateValue:6},{label:"",value:0,className:""}],[{label:"JUL",value:1,className:"",isMonth:!0,dateValue:7},{label:"AUG",value:2,className:"",isMonth:!0,dateValue:8},{label:"SEP",value:3,className:"",isMonth:!0,dateValue:9},{label:"OCT",value:4,className:"",isMonth:!0,dateValue:10},{label:"NOV",value:5,className:"",isMonth:!0,dateValue:11},{label:"DEC",value:6,className:"",isMonth:!0,dateValue:12},{label:"",value:0,className:""}],[{label:"1",value:1,className:"",isMonth:!1,dateValue:1},{label:"2",value:2,className:"",isMonth:!1,dateValue:2},{label:"3",value:3,className:"",isMonth:!1,dateValue:3},{label:"4",value:4,className:"",isMonth:!1,dateValue:4},{label:"5",value:5,className:"",isMonth:!1,dateValue:5},{label:"6",value:6,className:"",isMonth:!1,dateValue:6},{label:"7",value:7,className:"",isMonth:!1,dateValue:7}],[{label:"8",value:8,className:"",isMonth:!1,dateValue:8},{label:"9",value:2,className:"",isMonth:!1,dateValue:9},{label:"10",value:3,className:"",isMonth:!1,dateValue:10},{label:"11",value:4,className:"",isMonth:!1,dateValue:11},{label:"12",value:5,className:"",isMonth:!1,dateValue:12},{label:"13",value:6,className:"",isMonth:!1,dateValue:13},{label:"14",value:0,className:"",isMonth:!1,dateValue:14}],[{label:"15",value:1,className:"",isMonth:!1,dateValue:15},{label:"16",value:2,className:"",isMonth:!1,dateValue:16},{label:"17",value:3,className:"",isMonth:!1,dateValue:17},{label:"18",value:4,className:"",isMonth:!1,dateValue:18},{label:"19",value:5,className:"",isMonth:!1,dateValue:19},{label:"20",value:6,className:"",isMonth:!1,dateValue:20},{label:"21",value:0,className:"",isMonth:!1,dateValue:21}],[{label:"22",value:1,className:"",isMonth:!1,dateValue:22},{label:"23",value:2,className:"",isMonth:!1,dateValue:23},{label:"24",value:3,className:"",isMonth:!1,dateValue:24},{label:"25",value:4,className:"",isMonth:!1,dateValue:25},{label:"26",value:5,className:"",isMonth:!1,dateValue:26},{label:"27",value:6,className:"",isMonth:!1,dateValue:27},{label:"28",value:0,className:"",isMonth:!1,dateValue:28}],[{label:"29",value:1,className:"",isMonth:!1,dateValue:29},{label:"30",value:2,className:"",isMonth:!1,dateValue:30},{label:"31",value:3,className:"",isMonth:!1,dateValue:31},{label:"",value:4,className:""},{label:"",value:5,className:""},{label:"",value:0,className:""},{label:"",value:0,className:""}]],g=p.reduce(((e,t)=>(e[t.id]=t,e)),{});let v=[{id:5,left:15*m,top:4*m,transform:"",value:[[1,1,0,0],[1,1,0,0],[1,1,0,0],[0,0,0,0]]},{id:2,left:15*m,top:9*m,transform:"",value:[[1,1,0,0],[1,0,0,0],[1,1,0,0],[0,0,0,0]]},{id:8,left:18*m,top:4*m,transform:"",value:[[1,1,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]]},{id:1,left:0*m,top:9*m,transform:"",value:[[1,1,1,0],[1,0,0,0],[1,0,0,0],[0,0,0,0]]},{id:6,left:0,top:4*m,transform:"",value:[[1,0,0,0],[1,1,0,0],[1,1,0,0],[0,0,0,0]]},{id:7,left:4*m,top:9*m,transform:"",value:[[1,0,0,0],[1,1,0,0],[1,0,0,0],[1,0,0,0]]},{id:3,left:3*m,top:4*m,transform:"",value:[[1,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]]},{id:4,left:18*m,top:9*m,transform:"",value:[[1,0,0,0],[1,0,0,0],[1,1,0,0],[0,1,0,0]]}];const b=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,-1,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,-1,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0],[0,0,0,0,0,0,2,0,0,0,-1,-1,-1,-1,2,0,0,0,0,0],[0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];(function(e){e.forEach((e=>{const t=g[e.id],a=e.value;e.color=t.color,a.forEach((e=>{for(let a=0;a<e.length;a++)1===e[a]&&(e[a]=t.value)}))}))})(v);const z=function(){const e=p.map((e=>e.color));return e.unshift("transparent"),e}(),y=function(){const e=[];return _(!0,f[0],e),_(!0,f[1],e),e}(),C=function(){const e=[];return _(!1,f[2],e),_(!1,f[3],e),_(!1,f[4],e),_(!1,f[5],e),_(!1,f[6],e),e}();function _(e,t,a){t.forEach((t=>{t.isMonth==e&&t.dateValue&&a.push({label:t.label,value:t.dateValue})}))}const k=function(e){return e=JSON.parse(JSON.stringify(e)),e.reverse()},x=function(e){e=JSON.parse(JSON.stringify(e));let t=[];return t=e.map(((t,a)=>{let s=[];for(let l=t.length-1;l>=0;l--)s.push(e[l][a]);return s})),e.forEach(((a,s)=>{e[s]=t[s]})),e};var w=a(2415);s["default"].use(d.ZP);const N=(0,w.Z)({paths:["userInfo","token"]}),I=new d.ZP.Store({state:{queue:JSON.parse(JSON.stringify(b)),userInfo:{name:"",id:1},cellSide:m,token:""},getters:{getQueue:e=>e.queue,getUserInfo:e=>e.userInfo,getCellSide:e=>e.cellSide,getToken:e=>e.token},mutations:{setQueue(e,t){e.queue=t},setUserInfo(e,t){e.userInfo=t},setToken(e,t){e.token=t}},plugins:[N]});var P=I,S=a(2631),M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"box"},[t("div",{staticClass:"box-title"},[e._v("欢迎登录")]),t("div",{staticClass:"box-middle"},[t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},[t("i",{staticClass:"el-icon-user",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[t("i",{staticClass:"el-icon-lock",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"login-but cur-poi",on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.login.apply(null,arguments)}}},[e._v("登录")])]),t("div",{staticClass:"box-foot"},[t("div",{staticClass:"cur-poi",on:{click:e.regAcc}},[e._v("注册账号")]),t("div",{staticClass:"cur-poi",on:{click:e.forPass}},[e._v("忘记密码")])])])},$=[],V={name:"loginPage",components:{},data(){return{account:"",password:""}},computed:{},created(){},mounted(){},methods:{...(0,d.OI)(["setUserInfo","setToken"]),login(){this.$api.puzzle.login({username:this.account,password:this.password}).then((e=>{const{data:t}=e,a={name:t.user_name,id:t.user_id};this.setUserInfo(a),this.setToken(t.token),this.$router.push("/home")}))},regAcc(){console.log("注册账号"),this.$router.push("/reg")},forPass(){this.$router.push("/res")}}},L=V,G=(0,r.Z)(L,M,$,!1,null,"2faad24d",null),T=G.exports,O=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"home-user"},[t("user-avatar")],1),t("div",{staticClass:"home-tabs"},[t("div",{staticClass:"tabs-main"},[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.tabClick}},[t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-house"}),e._v(" 游戏大厅")]),t("game-hall",{ref:"gameHall"})],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-trophy"}),e._v(" 排行榜")]),t("ranking-list",{ref:"rankList"})],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-time"}),e._v(" 游戏记录")]),t("game-record",{ref:"gameRecord"})],1)],1)],1)])])},A=[],B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"game-hall-box"},[t("div",{staticClass:"title-box"},[t("div",{staticClass:"create-home",on:{click:function(t){e.dialogVisible=!0}}},[e._v("创建房间")])]),t("div",{staticClass:"puzzle-list-box"},e._l(e.puzzleList,(function(a){return t("div",{key:a.id,staticClass:"puzzle-item-box",on:{click:function(t){return e.goToDetail(a.id)}}},[t("div",{staticClass:"puzzle-item-title"},[t("div",{staticClass:"puz-title__left"},[e._v(" "+e._s(a.gameName)+"["+e._s(a.month)+"."+e._s(a.day)+"] ")]),t("div",{staticClass:"puz-title__right"},[e._v(e._s(a.duration))])]),t("show-puzzle",{attrs:{boxHeight:280,boxWidth:280,matrixValue:a.matrixValue,curMonth:a.month,curDay:a.day}})],1)})),0),t("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:e.total,"current-page":e.curPage,"page-size":e.curPageSize},on:{"current-change":e.curPageChange}}),t("el-dialog",{attrs:{title:"创建房间",visible:e.dialogVisible,width:"500px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"homeInfo",attrs:{model:e.homeInfo,"status-icon":"","label-width":"100px"}},[t("el-form-item",{attrs:{label:"房间名称",required:"",prop:"gameName"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.homeInfo.gameName,callback:function(t){e.$set(e.homeInfo,"gameName",t)},expression:"homeInfo.gameName"}})],1),t("el-form-item",{attrs:{label:"月",required:"",prop:"month"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.homeInfo.month,callback:function(t){e.$set(e.homeInfo,"month",t)},expression:"homeInfo.month"}},e._l(e.optionMonths,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"日",required:"",prop:"day"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.homeInfo.day,callback:function(t){e.$set(e.homeInfo,"day",t)},expression:"homeInfo.day"}},e._l(e.optionDays,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("homeInfo")}}},[e._v("确认")]),t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("退出")])],1)],1)],1)],1)},R=[],q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"puzzle-box",style:`width:${e.boxWidth}px;height:${e.boxHeight}px`},e._l(e.puzzleCellList,(function(a,s){return t("div",{key:s,staticClass:"box-row"},e._l(a,(function(a,l){return t("div",{key:l,staticClass:"box-cell",class:a.className,style:e.comCellStyle(a.isMonth,a.value,a.dateValue,s,l)},[e._v(e._s(a.label))])})),0)})),0)},U=[],D={name:"ShowPuzzle",props:{matrixValue:{type:Array,require:!0},boxWidth:{type:Number,require:!0},boxHeight:{type:Number,require:!0},curMonth:{type:Number,require:!0},curDay:{type:Number,require:!0}},components:{},data(){return{}},computed:{},created(){this.puzzleCellList=f},mounted(){},methods:{comCellStyle(e,t,a,s,l){let o=`width:${this.boxWidth/7}px;height:${this.boxHeight/7}px;`;return(e&&a==this.curMonth||!e&&a==this.curDay)&&(o+="color:black;font-weight:bold;"),o+=`background-color:${z[this.matrixValue[s][l]]}`,o}}},H=D,Z=(0,r.Z)(H,q,U,!1,null,"8df64126",null),Q=Z.exports;let j=null;var J={name:"GameHall",components:{showPuzzle:Q},data(){return{puzzleList:[],total:0,curPage:1,curPageSize:6,dialogVisible:!1,homeInfo:{gameName:"",month:1,day:1,id:1},optionMonths:y,optionDays:C}},computed:{...(0,d.Se)(["getUserInfo"])},watch:{curPage:function(){this.getPuzzleList()}},created(){},mounted(){this.getPuzzleList(),this.createTimer()},methods:{...(0,d.OI)(["setQueue"]),getPuzzleList(){this.$api.puzzle.getGameRealList({pagination:this.curPage,pagesize:this.curPageSize}).then((e=>{const t=[],{data:a}=e;a.forEach((e=>{const a=e.puzzle_date.split(".");t.push({id:e.game_id,gameName:e.game_name,userName:e.player,matrixValue:e.puzzle_cell,duration:e.puzzle_duration,month:Number.parseInt(a[0]),day:Number.parseInt(a[1])})})),this.puzzleList=t,this.total=e.total}))},goToDetail(e){this.$router.push({path:"/detail",query:{id:e}})},handleClose(e){this.$confirm("确认关闭？").then((()=>{e()})).catch((()=>{}))},curPageChange(e){this.curPage=e,this.getPuzzleList()},submitForm(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;{this.dialogVisible=!1;const e={game_name:this.homeInfo.gameName,player:this.getUserInfo.name,month:this.homeInfo.month,day:this.homeInfo.day};this.$api.puzzle.startNewGame(e).then((e=>{const{data:t}=e;this.$message.success("创建游戏成功！"),this.homeInfo.id=t["game_id"],this.setQueue(JSON.parse(JSON.stringify(b))),this.$router.push({path:"/play",query:{...this.homeInfo}})}))}}))},createTimer(){const e=this;j=setInterval((()=>{e.getPuzzleList()}),1e3)},clearTimer(){clearInterval(j)}},beforeDestroy(){this.clearTimer()}},W=J,E=(0,r.Z)(W,B,R,!1,null,"6bbe91c3",null),F=E.exports,X=function(){var e=this,t=e._self._c;return t("div",{staticClass:"rank-box"},[t("div",{staticClass:"rank-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"player",label:"玩家"}}),t("el-table-column",{attrs:{prop:"puzzle_date",label:"解密日期"}}),t("el-table-column",{attrs:{prop:"puzzle_start",label:"开始时间"}}),t("el-table-column",{attrs:{prop:"puzzle_duration",label:"游戏时长"}}),t("el-table-column",{attrs:{prop:"status",label:"状态"}})],1)],1),t("div",{staticClass:"rank-page"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:e.total,"current-page":e.curPage,"page-size":e.curPageSize},on:{"current-change":e.curPageChange}})],1)])},Y=[],K={name:"GameRecord",components:{},data(){return{tableData:[],total:0,curPage:1,curPageSize:10}},computed:{...(0,d.Se)(["getUserInfo"])},created(){},mounted(){this.getGameRecordList()},methods:{getGameRecordList(){this.$api.puzzle.getGameHistoryList({pagination:this.curPage,pagesize:this.curPageSize}).then((e=>{this.tableData=e.data,this.total=e.total}))},curPageChange(e){this.curPage=e,this.getGameRecordList()}}},ee=K,te=(0,r.Z)(ee,X,Y,!1,null,"4af8d791",null),ae=te.exports,se=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-box"},[t("el-dropdown",{on:{command:e.quitLogin}},[t("span",{staticClass:"el-dropdown-link"},[e._v(" 你好，"+e._s(e.getUserInfo.name)+" ")]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[e._v("退出")])],1)],1)],1)},le=[],oe={name:"UserAvatar",components:{},data(){return{}},computed:{...(0,d.Se)(["getUserInfo"])},created(){},mounted(){},methods:{...(0,d.OI)(["setUserInfo","setToken"]),quitLogin(){this.$api.puzzle.logout({user_id:this.getUserInfo.id}).then((()=>{this.setToken(""),this.setUserInfo(""),this.$router.push("/")}))}}},ne=oe,ie=(0,r.Z)(ne,se,le,!1,null,"4eddad2c",null),re=ie.exports,ue=function(){var e=this,t=e._self._c;return t("div",{staticClass:"rank-box"},[t("div",{staticClass:"rank-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"rank",label:"排行"}}),t("el-table-column",{attrs:{prop:"player",label:"玩家"}}),t("el-table-column",{attrs:{prop:"puzzle_date",label:"解密日期"}}),t("el-table-column",{attrs:{prop:"puzzle_duration",label:"游戏时长"}})],1)],1),t("div",{staticClass:"rank-page"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:e.total,"current-page":e.curPage,"page-size":e.curPageSize},on:{"current-change":e.curPageChange}})],1)])},ce=[],de={name:"RankingList",components:{},data(){return{tableData:[],total:0,curPage:1,curPageSize:10}},computed:{...(0,d.Se)(["getUserInfo"])},created(){},mounted(){this.getGameRankList()},methods:{getGameRankList(){this.$api.puzzle.getGameRankList({pagination:this.curPage,pagesize:this.curPageSize}).then((e=>{this.tableData=e.data,this.total=e.total}))},curPageChange(e){this.curPage=e,this.getGameRankList()}}},me=de,pe=(0,r.Z)(me,ue,ce,!1,null,"63f01397",null),he=pe.exports,fe={name:"HomePage",components:{GameHall:F,GameRecord:ae,RankingList:he,UserAvatar:re},data(){return{}},computed:{},created(){},mounted(){},methods:{tabClick(e){switch(e.index){case"0":this.$refs.gameHall.createTimer();break;case"1":this.$refs.rankList.getGameRankList(),this.$refs.gameHall.clearTimer();break;case"2":this.$refs.gameRecord.getGameRecordList(),this.$refs.gameHall.clearTimer();break;default:break}}}},ge=fe,ve=(0,r.Z)(ge,O,A,!1,null,null,null),be=ve.exports,ze=function(){var e=this,t=e._self._c;return t("div",{staticClass:"game-view"},[t("div",{staticClass:"view-header",style:`width:${e.infoWidth}px;`},[t("div",{staticClass:"view-header--left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.quitGame}},[e._v("退出游戏")])],1),t("div",{staticClass:"view-header__name"},[e._v(e._s(e.homeInfo.gameName))]),t("div",{staticClass:"view-header--right"},[t("user-avatar")],1)]),t("div",[t("div",[t("div",{staticClass:"game-info",style:`width:${e.infoWidth}px`},[t("div",{staticClass:"game-info--left"},[e._v("玩家："+e._s(e.getUserInfo.name))]),t("div",{staticClass:"game-info--right"},[e._v("游戏时长："+e._s(e.comDuration))])])]),t("div",[t("block-view")],1)])])},ye=[],Ce=function(){var e=this,t=e._self._c;return t("div",{staticClass:"block-grid",style:`--cell-side:${e.getCellSide}px;`},[t("puzzle-queue"),e._l(e.allPuzzleCell,(function(e,a){return t("puzzle-cell",{key:a,attrs:{puzCel:e,valueArr:e.value}})})),e._m(0)],2)},_e=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"block-button"},[e._v(" 左键单击顺时针90度旋转"),t("br"),e._v("右键单击翻转変换"),t("br"),e._v("拼盘附近不可放置"),t("br"),e._v("刷新页面将重置"),t("br"),e._v("第一次完成游戏后将不再计时 ")])}],ke=function(){var e=this,t=e._self._c;return t("div",{ref:"puzBlockBox",staticClass:"puz-block-box",on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:(t.preventDefault(),e.move.apply(null,arguments))},contextmenu:function(t){return t.preventDefault(),e.clickRightPuz()}}},e._l(e.puzValMat,(function(a,s){return t("div",{key:s,staticClass:"puzzle-row"},e._l(a,(function(a,l){return t("div",{key:l},[t("div",{staticClass:"puzzle-cell",style:e.computCellPos(s,l,a)})])})),0)})),0)},xe=[],we=a(4806);let Ne=0;var Ie={name:"BlockCell",props:{puzCel:{type:Object,require:!0},valueArr:{type:Array,require:!0}},inject:["homeInfo"],components:{},data(){return{puzValMat:this.valueArr,leftNum:this.puzCel.left,topNum:this.puzCel.top,puzBlockBoxSty:{left:`${this.puzCel.left}px`,top:`${this.puzCel.top}px`,zIndex:0,transition:"none",transform:""}}},computed:{...(0,d.Se)(["getQueue","getCellSide"])},watch:{},created(){},mounted(){const e=this;this.changePuzBox(this.puzBlockBoxSty),e.clickRightPuzThr=(0,we.throttle)((()=>{e.changePuzBox({transform:"rotateX(180deg)",transition:"transform 0.3s ease"},!0)}),500),e.clickleftPuzThr=(0,we.throttle)((()=>{e.changePuzBox({transform:"rotate(90deg)",transition:"transform 0.3s ease"},!0)}),500)},methods:{...(0,d.OI)(["setQueue"]),computCellPos(e,t,a){let s=`top:${e*this.getCellSide}px;left:${t*this.getCellSide}px;`;return s+=a?`background-color:${this.puzCel.color};border:0;`:"visibility:hidden;",s},saveGame(){this.$parent.$parent.saveGame(!1)},changePuzBox(e,t){const a=this.$refs["puzBlockBox"].style;for(const s in e)if(Object.hasOwnProperty.call(e,s)){const t=e[s];a[s]=t}t&&setTimeout((()=>{a.transform="",a.transition="none"}),300)},rotate(e){const t=this,a=this.leftNum,s=this.topNum,l=t.puzValMat,o=t.getQueue,n=e?x(l):k(l),i=a/t.getCellSide,r=s/t.getCellSide;for(let d=r;d<r+4;d++){const e=o[d];for(let t=i;t<i+4;t++)l[d-r][t-i]&&(e[t]=0)}const u=function(){for(let e=r;e<r+4;e++){const t=o[e];for(let a=i;a<i+4;a++)l[e-r][a-i]&&(t[a]=l[e-r][a-i])}const a=e?"旋转":"翻转";t.$message({message:`此位置不可${a}！`,type:"warning"})},c=function(){const e=a/t.getCellSide,l=s/t.getCellSide;let i=new Array(4).fill(null).map(((t,a)=>new Array(4).fill(0).map(((t,s)=>void 0!=o[l+a]&&void 0!=o[l+a][e+s]?o[l+a][e+s]:-1))));const r=i.some(((e,t)=>e.some(((e,a)=>e&&n[t][a]))));return!r};if(c()){e?t.clickleftPuzThr():t.clickRightPuzThr();for(let e=r;e<r+4;e++){const t=o[e];for(let a=i;a<i+4;a++)n[e-r][a-i]&&(t[a]=n[e-r][a-i])}setTimeout((()=>{t.setQueue(JSON.parse(JSON.stringify(o))),t.puzValMat=n,t.saveGame()}),300)}else u()},changePuzbloSty(e){const t=e,a=this.$refs["puzBlockBox"].style;for(const s in t)if(Object.hasOwnProperty.call(t,s)){const e=t[s];a[s]=e}},clickRightPuz(){this.rotate(!1)},move(e){const t=this,a=t.puzBlockBoxSty,s=e.currentTarget,l=t.getQueue;a.zIndex=Ne++;let o=e.pageX-s.offsetLeft,n=e.pageY-s.offsetTop,i=s.offsetLeft,r=s.offsetTop,u=s.offsetLeft,c=s.offsetTop,d=Math.round(s.offsetLeft/t.getCellSide),m=Math.round(s.offsetTop/t.getCellSide);const p=this.puzValMat;for(let v=m;v<m+4;v++){const e=l[v];for(let t=d;t<d+4;t++)p[v-m][t-d]&&(e[t]=0)}let h=!0;document.onmousemove=function(e){h=!1,i=e.pageX-o,r=e.pageY-n,a.left=i+"px",a.top=r+"px",t.changePuzBox(a)},document.onmouseup=function(){if(document.onmousemove=document.onmouseup=null,h||Math.abs(i-u)<5&&Math.abs(r-c)<5)t.rotate(!0);else{const e=i%t.getCellSide,s=r%t.getCellSide;i-=i%t.getCellSide,r-=r%t.getCellSide,e>0?e>t.getCellSide/2&&(i+=t.getCellSide):e<-t.getCellSide/2&&(i-=t.getCellSide),s>0?s>t.getCellSide/2&&(r+=t.getCellSide):s<-t.getCellSide/2&&(r-=t.getCellSide);const o=Math.round(i/t.getCellSide),n=Math.round(r/t.getCellSide);if(g()){a.transition="all 0.15s ease-out",a.left=i+"px",a.top=r+"px",t.changePuzBox(a),setTimeout((()=>{a.transition="none",t.changePuzBox(a)}),150),t.leftNum=i,t.topNum=r;for(let e=n;e<n+4;e++){const t=l[e];for(let a=o;a<o+4;a++)p[e-n][a-o]&&(t[a]=p[e-n][a-o])}t.setQueue(JSON.parse(JSON.stringify(l))),t.saveGame()}else f()}};const f=function(){a.transition="all 0.3s linear",a.left=u+"px",a.top=c+"px",t.changePuzBox(a),setTimeout((()=>{a.transition="none",t.changePuzBox(a)}),300);for(let e=m;e<m+4;e++){const t=l[e];for(let a=d;a<d+4;a++)p[e-m][a-d]&&(t[a]=p[e-m][a-d])}t.$message({message:"不可移动到此位置！",type:"warning"})},g=function(){const e=i/t.getCellSide,a=r/t.getCellSide;let s=new Array(4).fill(null).map(((t,s)=>new Array(4).fill(0).map(((t,o)=>void 0!=l[a+s]&&void 0!=l[a+s][e+o]?l[a+s][e+o]:-1))));const o=s.some(((e,t)=>e.some(((e,a)=>e&&p[t][a]))));return!o}}}},Pe=Ie,Se=(0,r.Z)(Pe,ke,xe,!1,null,"45129501",null),Me=Se.exports,$e=function(){var e=this,t=e._self._c;return t("div",{staticClass:"queue-grid"},[e._l(e.getQueue,(function(a,s){return t("div",{key:s,staticClass:"row"},e._l(a,(function(e,a){return t("div",{key:a,staticClass:"cell"})})),0)})),t("div",{staticClass:"queue-puz-block"},[t("show-puzzle",{attrs:{matrixValue:e.curGameInfo.matrixValue,curMonth:e.curGameInfo.month,curDay:e.curGameInfo.day,boxWidth:7*e.getCellSide,boxHeight:7*e.getCellSide}})],1)],2)},Ve=[],Le={name:"BlockCell",props:{},components:{showPuzzle:Q},inject:["homeInfo"],data(){return{curGameInfo:h}},computed:{...(0,d.Se)(["getQueue","getCellSide"])},mounted(){this.curGameInfo.month=this.homeInfo.month,this.curGameInfo.day=this.homeInfo.day},methods:{}},Ge=Le,Te=(0,r.Z)(Ge,$e,Ve,!1,null,"6aab5676",null),Oe=Te.exports,Ae={name:"BlockCell",props:{},components:{puzzleCell:Me,puzzleQueue:Oe},data(){return{result:[]}},computed:{...(0,d.Se)(["getQueue","getCellSide"])},created(){this.allPuzzleCell=v;const e=this.getQueue;this.allPuzzleCell.forEach((t=>{const a=t.left,s=t.top,l=t.value,o=a/this.getCellSide,n=s/this.getCellSide;for(let i=n;i<n+4;i++){const t=e[i];for(let e=o;e<o+4;e++)l[i-n][e-o]&&(t[e]=l[i-n][e-o])}})),this.setQueue(JSON.parse(JSON.stringify(e)))},mounted(){},methods:{...(0,d.OI)(["setQueue"])},destroyed(){}},Be=Ae,Re=(0,r.Z)(Be,Ce,_e,!1,null,"dfc973e6",null),qe=Re.exports;let Ue=null;var De={name:"PlayGame",components:{blockView:qe,userAvatar:re},provide(){return{homeInfo:this.homeInfo}},data(){const e=this.$route.query;return{infoWidth:20*m,homeInfo:{id:Number.parseInt(e.id),duration:"00:00",gameName:e.gameName,month:Number.parseInt(e.month),day:Number.parseInt(e.day),countTim:0}}},computed:{...(0,d.Se)(["getUserInfo","getQueue"]),comDuration(){const e=this.homeInfo.countTim;return`${Math.floor(e/60)}:${e%60}`}},beforeCreate(){},created(){},mounted(){const e=this;this.userName=this.getUserInfo.name,e.saveGame(!0),Ue=setInterval((()=>{e.homeInfo.countTim++,e.saveGame(!0)}),1e3)},methods:{saveGame(e){const t=this.getQueue,a=[];for(let l=4;l<11;l++){const e=t[l],s=[];for(let t=7;t<14;t++)s.push(e[t]);a.push(s)}const s={game_id:this.homeInfo.id,duration_seconds:this.homeInfo.countTim,puzzle_cell:a};this.$api.puzzle.getGameStatus(s).then((t=>{if(!e){const{data:e}=t;e.game_over&&(this.clearTimer(),this.$message({message:"恭喜你，完成拼图！",type:"success"}))}}))},quitGame(){this.$api.puzzle.terminateGame({game_id:this.homeInfo.id}).then((()=>{this.$router.push("/home")}))},clearTimer(){window.clearInterval(Ue)}},destroyed(){this.clearTimer()}},He=De,Ze=(0,r.Z)(He,ze,ye,!1,null,"3c82592a",null),Qe=Ze.exports,je=function(){var e=this,t=e._self._c;return t("div",{staticClass:"game-view"},[t("div",{staticClass:"view-header"},[t("div",{staticClass:"view-header--left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.backHall}},[e._v("返回大厅")])],1),t("div",{staticClass:"view-header__name"},[e._v(e._s(e.homeInfo.gameName))]),t("div",{staticClass:"view-header--right"},[t("user-avatar")],1)]),t("div",[t("div",[t("div",{staticClass:"game-info",style:`width:${e.infoWidth}px`},[t("div",{staticClass:"game-info--left"},[e._v("玩家："+e._s(e.homeInfo.player))]),t("div",{staticClass:"game-info--right"},[e._v("游戏时长："+e._s(e.homeInfo.duration))])])]),t("div",{staticClass:"game-block",style:`width:${e.infoWidth}px`},[t("show-puzzle",{attrs:{matrixValue:e.homeInfo.matrixValue,curMonth:e.homeInfo.month,curDay:e.homeInfo.day,duration:e.homeInfo.duration,boxWidth:e.infoWidth,boxHeight:e.infoWidth}})],1)])])},Je=[];let We=null;var Ee={name:"GameDetail",components:{showPuzzle:Q,userAvatar:re},data(){return{homeInfo:{id:1,matrixValue:[[0,0,0,0,0,0,-1],[0,0,0,0,0,0,-1],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,-1,-1,-1,-1]],month:1,day:1,gameName:"",duration:"00:00",player:""},infoWidth:350}},computed:{...(0,d.Se)(["getCellSide","getUserInfo"])},created(){},mounted(){const e=this;this.id=this.$route.query.id,e.getHomeInfo(),We=setInterval((()=>{e.getHomeInfo()}),1e3)},methods:{getHomeInfo(){this.$api.puzzle.getGameInfoById({game_id:this.id}).then((e=>{const{data:t}=e;this.homeInfo.matrixValue=t.puzzle_cell,this.homeInfo.duration=t.puzzle_duration,this.homeInfo.player=t.player}))},backHall(){this.$router.push("/home")}},destroyed(){clearInterval(We)}},Fe=Ee,Xe=(0,r.Z)(Fe,je,Je,!1,null,"094fee62",null),Ye=Xe.exports,Ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"box"},[t("div",{staticClass:"box-title"},[e._v("欢迎注册")]),t("div",{staticClass:"box-middle"},[t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},[t("i",{staticClass:"el-icon-user",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[t("i",{staticClass:"el-icon-lock",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"login-but cur-poi",on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.register.apply(null,arguments)}}},[e._v(" 注册 ")])]),t("div",{staticClass:"box-foot"},[t("div",{staticClass:"cur-poi"}),t("div",{staticClass:"cur-poi",on:{click:e.goLogin}},[e._v("已有账号，去登录")])])])},et=[],tt={name:"loginPage",components:{},data(){return{account:"",password:""}},computed:{},created(){},mounted(){},methods:{register(){this.$api.puzzle.register({username:this.account,password:this.password}).then((()=>{this.$message.success("注册成功"),this.goLogin()}))},goLogin(){this.$router.push("/")}}},at=tt,st=(0,r.Z)(at,Ke,et,!1,null,"2f416d5c",null),lt=st.exports,ot=function(){var e=this,t=e._self._c;return t("div",{staticClass:"box"},[t("div",{staticClass:"box-title"},[e._v("重置密码")]),t("div",{staticClass:"box-middle"},[t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},[t("i",{staticClass:"el-icon-user",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"acc-pass"},[t("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[t("i",{staticClass:"el-icon-lock",attrs:{slot:"prepend"},slot:"prepend"})])],1),t("div",{staticClass:"login-but cur-poi",on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.resetPassword.apply(null,arguments)}}},[e._v(" 重置 ")])]),t("div",{staticClass:"box-foot"},[t("div"),t("div",{staticClass:"cur-poi",on:{click:e.goLogin}},[e._v("已有账号，去登录")])])])},nt=[],it={name:"resetPassword",components:{},data(){return{account:"",password:""}},computed:{},created(){},mounted(){},methods:{resetPassword(){this.$api.puzzle.resetPassword({username:this.account,password:this.password}).then((()=>{this.$message.success("重置成功！"),this.goLogin()}))},goLogin(){this.$router.push("/")}}},rt=it,ut=(0,r.Z)(rt,ot,nt,!1,null,"3754b2df",null),ct=ut.exports,dt=a(8499),mt=a.n(dt);s["default"].use(S.Z);const pt=[{path:"/",name:"LoginPage",component:T},{path:"/play",name:"PlayGame",component:Qe},{path:"/home",name:"HomePage",component:be},{path:"/reg",name:"RegisteredAccount",component:lt},{path:"/res",name:"ResetPassword",component:ct},{path:"/detail",name:"GameDetail",component:Ye}],ht=new S.Z({routes:pt});ht.beforeEach(((e,t,a)=>{const s=P.getters.getToken;if("/"===e.path||"/reg"===e.path||"/res"===e.path)s&&"/"===e.path?a("/home"):a();else{const e=P.getters.getUserInfo;e&&s?a():(dt.Message.warning("未登录，请先登录！"),a("/"))}}));var ft=ht,gt=a(6265),vt=a.n(gt);const bt=()=>{ft.replace({path:"/",query:{redirect:ft.currentRoute.fullPath}})},zt=(e,t)=>{switch(e){case 401:dt.Message.error("未登录，请重新登录!"),bt();break;case 403:dt.Message.error("登录过期，请重新登录!"),P.commit("setToken",""),P.commit("setUserInfo",""),setTimeout((()=>{bt()}),1e3);break;case 404:dt.Message.error("请求的资源不存在");break;default:dt.Message.error("未知异常！"),console.log(t)}};var yt=vt().create({timeout:12e3});yt.defaults.headers.post["Content-Type"]="application/json",yt.interceptors.request.use((e=>{const t=P.state.token;return t&&(e.headers.Authorization=t),e}),(e=>Promise.error(e))),yt.interceptors.response.use((e=>{if(200===e.status){const{data:t}=e;return"200"!==t.code?((0,dt.Message)({message:t.message,type:"error"}),Promise.reject(t.message)):t}Promise.reject(e)}),(e=>{const{response:t}=e;return t?(zt(t.status,t.data.message),Promise.reject(t)):window.navigator.onLine?Promise.reject(e):void 0}));var Ct=yt;let _t="";const kt={abrotGame(e){return Ct.post(`${_t}/abort-game/`,e)},getGameHistoryList(e){return Ct.post(`${_t}/get-game-history-list/`,e)},getGameRankList(e){return Ct.post(`${_t}/get-game-rank-list/`,e)},getGameRealList(e){return Ct.post(`${_t}/get-game-real-time-list/`,{...e})},getGameStatus(e){return Ct.post(`${_t}/get-game-status/`,e)},getGameInfoById(e){return Ct.post(`${_t}/get-game-info-byid/`,e)},terminateGame(e){return Ct.post(`${_t}/terminate-game/`,e)},startNewGame(e){return Ct.post(`${_t}/start-new-game/`,e)},login(e){return Ct.post(`${_t}/login/`,e)},register(e){return Ct.post(`${_t}/register/`,e)},resetPassword(e){return Ct.put(`${_t}/register/`,e)},logout(e){return Ct.post(`${_t}/logout/`,e)}};var xt=kt,wt={puzzle:xt};s["default"].prototype.$api=wt,s["default"].use(mt()),s["default"].config.productionTip=!1,new s["default"]({store:P,router:ft,render:e=>e(c)}).$mount("#app")}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){var e=[];a.O=function(t,s,l,o){if(!s){var n=1/0;for(c=0;c<e.length;c++){s=e[c][0],l=e[c][1],o=e[c][2];for(var i=!0,r=0;r<s.length;r++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(i=!1,o<n&&(n=o));if(i){e.splice(c--,1);var u=l();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,l,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,o,n=s[0],i=s[1],r=s[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(r)var c=r(a)}for(t&&t(s);u<n.length;u++)o=n[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},s=self["webpackChunkcalendar_puzzle_vue"]=self["webpackChunkcalendar_puzzle_vue"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(1438)}));s=a.O(s)})();
//# sourceMappingURL=app.55e2eb7b.js.map